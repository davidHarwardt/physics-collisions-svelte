var Ge=Object.defineProperty;var Ke=(r,t,e)=>t in r?Ge(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var C=(r,t,e)=>(Ke(r,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();function j(){}function Ie(r){return r()}function Ee(){return Object.create(null)}function et(r){r.forEach(Ie)}function Ue(r){return typeof r=="function"}function Nt(r,t){return r!=r?t==t:r!==t||r&&typeof r=="object"||typeof r=="function"}function Je(r){return Object.keys(r).length===0}function Qe(r,...t){if(r==null)return j;const e=r.subscribe(...t);return e.unsubscribe?()=>e.unsubscribe():e}function Ze(r,t,e){r.$$.on_destroy.push(Qe(t,e))}function a(r,t){r.appendChild(t)}function Me(r,t,e){r.insertBefore(t,e||null)}function Vt(r){r.parentNode.removeChild(r)}function w(r){return document.createElement(r)}function U(r){return document.createTextNode(r)}function v(){return U(" ")}function L(r,t,e,n){return r.addEventListener(t,e,n),()=>r.removeEventListener(t,e,n)}function ti(r){return function(t){return t.preventDefault(),r.call(this,t)}}function P(r,t,e){e==null?r.removeAttribute(t):r.getAttribute(t)!==e&&r.setAttribute(t,e)}function ei(r){return Array.from(r.childNodes)}function Et(r,t){t=""+t,r.wholeText!==t&&(r.data=t)}let ut;function ot(r){ut=r}function ii(){if(!ut)throw new Error("Function called outside component initialization");return ut}function ni(r){ii().$$.on_mount.push(r)}const st=[],D=[],_t=[],$t=[],ri=Promise.resolve();let Rt=!1;function si(){Rt||(Rt=!0,ri.then(ze))}function Wt(r){_t.push(r)}function Y(r){$t.push(r)}const qt=new Set;let wt=0;function ze(){const r=ut;do{for(;wt<st.length;){const t=st[wt];wt++,ot(t),li(t.$$)}for(ot(null),st.length=0,wt=0;D.length;)D.pop()();for(let t=0;t<_t.length;t+=1){const e=_t[t];qt.has(e)||(qt.add(e),e())}_t.length=0}while(st.length);for(;$t.length;)$t.pop()();Rt=!1,qt.clear(),ot(r)}function li(r){if(r.fragment!==null){r.update(),et(r.before_update);const t=r.dirty;r.dirty=[-1],r.fragment&&r.fragment.p(r.ctx,t),r.after_update.forEach(Wt)}}const bt=new Set;let oi;function V(r,t){r&&r.i&&(bt.delete(r),r.i(t))}function B(r,t,e,n){if(r&&r.o){if(bt.has(r))return;bt.add(r),oi.c.push(()=>{bt.delete(r),n&&(e&&r.d(1),n())}),r.o(t)}else n&&n()}function H(r,t,e){const n=r.$$.props[t];n!==void 0&&(r.$$.bound[n]=e,e(r.$$.ctx[n]))}function G(r){r&&r.c()}function O(r,t,e,n){const{fragment:i,on_mount:s,on_destroy:l,after_update:o}=r.$$;i&&i.m(t,e),n||Wt(()=>{const h=s.map(Ie).filter(Ue);l?l.push(...h):et(h),r.$$.on_mount=[]}),o.forEach(Wt)}function X(r,t){const e=r.$$;e.fragment!==null&&(et(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function ai(r,t){r.$$.dirty[0]===-1&&(st.push(r),si(),r.$$.dirty.fill(0)),r.$$.dirty[t/31|0]|=1<<t%31}function Te(r,t,e,n,i,s,l,o=[-1]){const h=ut;ot(r);const u=r.$$={fragment:null,ctx:null,props:s,update:j,not_equal:i,bound:Ee(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(h?h.$$.context:[])),callbacks:Ee(),dirty:o,skip_bound:!1,root:t.target||h.$$.root};l&&l(u.root);let E=!1;if(u.ctx=e?e(r,t.props||{},(_,y,...b)=>{const I=b.length?b[0]:y;return u.ctx&&i(u.ctx[_],u.ctx[_]=I)&&(!u.skip_bound&&u.bound[_]&&u.bound[_](I),E&&ai(r,_)),y}):[],u.update(),E=!0,et(u.before_update),u.fragment=n?n(u.ctx):!1,t.target){if(t.hydrate){const _=ei(t.target);u.fragment&&u.fragment.l(_),_.forEach(Vt)}else u.fragment&&u.fragment.c();t.intro&&V(r.$$.fragment),O(r,t.target,t.anchor,t.customElement),ze()}ot(h)}class De{$destroy(){X(this,1),this.$destroy=j}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const i=n.indexOf(e);i!==-1&&n.splice(i,1)}}$set(t){this.$$set&&!Je(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}class ke{constructor(...t){this.v=t}_makeThis(){return new this.__proto__.constructor(new Array(this.v.length).fill(0))}map(t){const e=this._makeThis();for(var n=0;n<this.v.length;n++)e.v[n]=t(this.v[n],n);return e}zipMap(t,e){return this.map((n,i)=>e(n,t.v[i],i))}reduce(t,e){let n=e;for(var i=0;i<this.v.length;i++)n=t(n,this.v[i],i);return n}zipReduce(t,e,n){return this.reduce((i,s,l)=>e(i,s,t.v[l],l),n)}copy(){return this.map(t=>t)}add(t){return this.zipMap(t,(e,n)=>e+n)}sub(t){return this.zipMap(t,(e,n)=>e-n)}mult(t){return this.zipMap(t,(e,n)=>e*n)}div(t){return this.zipMap(t,(e,n)=>e/n)}addS(t){return this.map(e=>e+t)}subS(t){return this.map(e=>e-t)}multS(t){return this.map(e=>e*t)}divS(t){return this.map(e=>e/t)}dot(t){return this.zipReduce(t,(e,n,i)=>e+n*i,0)}sqrMagnitude(){return this.dot(this)}magnitude(){return Math.sqrt(this.dot(this))}normalized(){return this.divS(this.magnitude())}inverted(){return this.multS(-1)}lerp(t,e){return this.multS(1-e).add(t.multS(e))}toArray(){return this.v.slice()}multM(t){return this.map((e,n)=>{let i=0;for(let s=0;s<t.rows;s++)i+=e*t.at(s,n);return i})}}class m extends ke{constructor(t,e){super(t,e)}get x(){return this.v[0]}get y(){return this.v[1]}set x(t){this.v[0]=t}set y(t){this.v[1]=t}}class Pe extends ke{constructor(t,e,n){super(t,e,n)}get x(){return this.v[0]}get y(){return this.v[1]}get z(){return this.v[2]}set x(t){this.v[0]=t}set y(t){this.v[1]=t}set z(t){this.v[2]=t}}class ui{constructor(...t){this.v=t}_makeThis(){return this.__proto__.constructor(new Array(this.v.length).fill(0))}map(t){const e=this._makeThis();for(var n=0;n<this.v.length;n++)e.v[n]=t(this.v[n],n);return e}zipMap(t,e){return this.map((n,i)=>e(n,t.v[i],i))}reduce(t,e){let n=e;for(var i=0;i<this.v.length;i++)n=t(n,this.v[i],i);return n}zipReduce(t,e,n){return this.reduce((i,s,l)=>e(i,s,t.v[l],l),n)}copy(){return this.map(t=>t)}add(t){return this.zipMap(t,(e,n)=>e+n)}sub(t){return this.zipMap(t,(e,n)=>e-n)}mult(t){return this.zipMap(t,(e,n)=>e*n)}div(t){return this.zipMap(t,(e,n)=>e/n)}addS(t){return this.map(e=>e+t)}subS(t){return this.map(e=>e-t)}multS(t){return this.map(e=>e*t)}divS(t){return this.map(e=>e/t)}dot(t){return this.zipReduce(t,(e,n,i)=>e+n*i,0)}sqrMagnitude(){return this.dot(this)}magnitude(){return Math.sqrt(this.dot(this))}normalized(){return this.divS(this.magnitude())}inverted(){return this.multS(-1)}lerp(t,e){return this.multS(1-e).add(t.multS(e))}toArray(){return this.v.slice()}multM(t){return this.map((e,n)=>{let i=0;for(let s=0;s<t.rows;s++)i+=e*t.at(s,n);return i})}}class di extends ui{constructor(t,e,n,i){super(t,e,n,i)}get x(){return this.v[0]}get y(){return this.v[1]}get z(){return this.v[2]}get w(){return this.v[3]}set x(t){this.v[0]=t}set y(t){this.v[1]=t}set z(t){this.v[2]=t}set w(t){this.v[3]=t}}function ci(r,t,e){return Math.min(Math.max(r,t),e)}class p{constructor(t,e,n,i=1){this.v=new di(t,e,n,i)}static get black(){return new p(0,0,0)}static get white(){return new p(1,1,1)}static get red(){return new p(1,0,0)}static get green(){return new p(0,1,0)}static get blue(){return new p(0,0,1)}static hex(t){if(typeof t=="number")return new p((t>>8*2&255)/255,(t>>8*1&255)/255,(t>>8*0&255)/255);if(!t.startsWith("#")||t.length!==7&&t.length!==9)throw new Error("invalid color string");let e=new Array((t.length-1)/2);for(let n=0;n<(t.length-1)/2;n++)e[n]=parseInt(t.substring(2*n+1,2*n+3),16)/255;return new p(e[0],e[1],e[2],e==null?void 0:e[3])}static hsl(t,e,n){}static vec(t){return new p(t.x,t.y,t.z,t.w)}hexComponent(t){return Math.floor(ci(t,0,1)*255).toString(16).padStart(2,"0")}toRgbString(t=this.a!==1){return`rgb${t?"a":""}(${Math.floor(this.r*255)}, ${Math.floor(this.g*255)}, ${Math.floor(this.b*255)}${t?", "+Math.floor(this.a*255):""})`}toHexString(t=this.a!==1){return`#${this.hexComponent(this.r)}${this.hexComponent(this.g)}${this.hexComponent(this.b)}${t?this.hexComponent(this.a):""}`}toString(){return this.toHexString()}toVec(){return this.v.copy()}toArray(){return this.v.toArray()}mix(t,e=.5){const n=new p(0,0,0,0);return n.v=this.v.multS(e).add(t.v.multS(1-e)),n}withAlpha(t){const e=this.clone();return e.a=t,e}get r(){return this.v.x}get g(){return this.v.y}get b(){return this.v.z}get a(){return this.v.w}set r(t){this.v.x=t}set g(t){this.v.y=t}set b(t){this.v.z=t}set a(t){this.v.w=t}clone(){return new p(this.r,this.g,this.b,this.a)}}class Pt{constructor(t){this.element=t,this.ctx=this.element.getContext("2d"),this.plugins=[]}static fromParent(t){const e=document.createElement("canvas");return t.appendChild(e),new Pt(e)}addPlugin(t){this.plugins.push(t)}clear(){this.ctx.clearRect(0,0,this.element.width,this.element.height)}beginDraw(){this.plugins.forEach(t=>t.beforeDrawBegin(this))}endDraw(){this.plugins.forEach(t=>t.afterDrawEnd(this))}draw(t){t(this.ctx)}drawLine(t,e,n={}){var i,s,l,o;this.ctx.lineWidth=(i=n.width)!==null&&i!==void 0?i:10,this.ctx.strokeStyle=(l=(s=n.color)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:p.red.toString(),this.ctx.lineCap=(o=n.cap)!==null&&o!==void 0?o:"butt",this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.stroke()}drawRect(t,e,n={}){var i,s,l,o;this.ctx.beginPath(),this.ctx.rect(t.x,t.y,e.x,e.y),n.fill!==!1&&(this.ctx.fillStyle=(s=(i=n.color)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:p.green.toString(),this.ctx.fill()),n.borderWidth>0&&(this.ctx.strokeStyle=(o=(l=n.borderColor)===null||l===void 0?void 0:l.toString())!==null&&o!==void 0?o:p.red.toString(),this.ctx.lineWidth=n.borderWidth,this.ctx.stroke())}drawCircle(t,e,n={}){var i,s,l,o;this.ctx.beginPath(),this.ctx.arc(t.x,t.y,e,0,Math.PI*2),n.fill!==!1&&(this.ctx.fillStyle=(s=(i=n.color)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:p.green.toString(),this.ctx.fill()),n.borderWidth>0&&(this.ctx.strokeStyle=(o=(l=n.borderColor)===null||l===void 0?void 0:l.toString())!==null&&o!==void 0?o:p.red.toString(),this.ctx.lineWidth=n.borderWidth,this.ctx.stroke())}drawPoly(t,e={}){var n,i,s,l;if(t.length<2){console.error(`invalid vertex count for polygon: ${t.length}`);return}this.ctx.beginPath(),this.ctx.moveTo(t[0].x,t[0].y);for(let o=1;o<t.length;o++)this.ctx.lineTo(t[o].x,t[o].y);e.closed===!0&&this.ctx.closePath(),e.fill!==!1&&(this.ctx.fillStyle=(i=(n=e.color)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:p.green.toString(),this.ctx.fill()),e.borderWidth>0&&(this.ctx.strokeStyle=(l=(s=e.borderColor)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:p.red.toString(),this.ctx.lineWidth=e.borderWidth,this.ctx.stroke())}drawBezier(t,e={}){}drawText(t,e,n={}){var i,s,l,o,h,u;this.ctx.fillStyle=(s=(i=n.color)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:p.white.toString(),this.ctx.textAlign=(l=n.align)!==null&&l!==void 0?l:"left",this.ctx.font=`${(o=n.size)!==null&&o!==void 0?o:50}px ${(h=n.font)!==null&&h!==void 0?h:"Arial"}`,this.ctx.textBaseline=(u=n.baseLine)!==null&&u!==void 0?u:"top",n.debug&&this.ctx.measureText(t),this.ctx.fillText(t,e.x,e.y,n.maxWidth)}drawImage(t,e,n=new m(t.width,t.height),i){i?this.ctx.drawImage(t,i.start.x,i.start.y,i.dim.x,i.dim.y,e.x,e.y,n.x,n.y):this.ctx.drawImage(t,e.x,e.y,n.x,n.y)}translate(t){this.ctx.translate(t.x,t.y)}scale(t,e){e&&this.translate(e),this.ctx.scale(t.x,t.y),e&&this.translate(e.inverted())}rotate(t,e){e&&this.translate(e),this.ctx.rotate(t),e&&this.translate(e.inverted())}resetTransform(){this.ctx.resetTransform()}saveCtx(){this.ctx.save()}restoreCtx(){this.ctx.restore()}screenToWorld(t){const e=this.ctx.getTransform().inverse();return new m(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f)}worldToScreen(t){const e=this.ctx.getTransform();return new m(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f)}clipRect(t,e){this.clip(n=>n.rect(t.x,t.y,e.x,e.y))}clipCircle(t,e){this.clip(n=>n.arc(t.x,t.y,e,0,Math.PI*2))}clip(t){this.ctx.beginPath(),t(this.ctx),this.ctx.clip()}getImageData(t,e=new m(1,1)){return this.ctx.getImageData(t.x,t.y,e.x,e.y)}createImageData(t){return this.ctx.createImageData(t.x,t.y)}putImageData(t,e){this.ctx.putImageData(t,e.x,e.y)}getPixel(t){console.error("todo")}}class hi{constructor(t,e=n=>{}){this.onResize=e,this.element=t}}class fi extends hi{constructor(t,e){super(t,e),new ResizeObserver(i=>{let s=new m(this.element.width,this.element.height);for(const l of i)this.element.width=l.contentRect.width,this.element.height=l.contentRect.height;this.onResize(new m(this.element.width,this.element.height),s)}).observe(this.element)}}class Ce extends fi{constructor(t,e){super(t,e),t.style.width="100%",t.style.height="100%"}}const Z=[];function gi(r,t=j){let e;const n=new Set;function i(o){if(Nt(r,o)&&(r=o,e)){const h=!Z.length;for(const u of n)u[1](),Z.push(u,r);if(h){for(let u=0;u<Z.length;u+=2)Z[u][0](Z[u+1]);Z.length=0}}}function s(o){i(o(r))}function l(o,h=j){const u=[o,h];return n.add(u),n.size===1&&(e=t(i)||j),o(r),()=>{n.delete(u),n.size===0&&(e(),e=null)}}return{set:i,update:s,subscribe:l}}class pi{constructor(t,e){C(this,"id");C(this,"pos");C(this,"lastPos");C(this,"data",{});this.pos=t,this.id=e,this.lastPos=t.copy()}setPos(t){this.pos=t}delta(){let t=this.pos.sub(this.lastPos);return this.lastPos=this.pos,t}}const tt=class{constructor(t){C(this,"parent");C(this,"pointers");C(this,"down",()=>{});C(this,"move",()=>{});C(this,"up",()=>{});this.parent=t,this.pointers=new Map,this.parent.addEventListener("touchstart",e=>{this.beginPointer(this.fromList(e.changedTouches))},{passive:!1}),this.parent.addEventListener("touchmove",e=>{e.preventDefault(),this.movePointer(this.fromList(e.changedTouches))},{passive:!1}),this.parent.addEventListener("touchend",e=>{this.removePointer(this.fromList(e.changedTouches))},{passive:!1}),this.parent.addEventListener("touchcancel",e=>{this.removePointer(this.fromList(e.changedTouches))}),this.parent.addEventListener("mousedown",e=>{this.beginPointer([{id:tt.POINTER_ID,pos:new m(e.clientX,e.clientY)}])},{passive:!1}),this.parent.addEventListener("mousemove",e=>{this.movePointer([{id:tt.POINTER_ID,pos:new m(e.clientX,e.clientY)}])},{passive:!1}),this.parent.addEventListener("mouseup",e=>{this.removePointer([{id:tt.POINTER_ID,pos:new m(e.clientX,e.clientY)}])},{passive:!1}),this.parent.addEventListener("mouseleave",e=>{this.removePointer([{id:tt.POINTER_ID,pos:new m(e.clientX,e.clientY)}])})}fromList(t){return new Array(t.length).fill(0).map((e,n)=>({id:t[n].identifier,pos:new m(t[n].clientX,t[n].clientY)}))}beginPointer(t){t.forEach(e=>{this.pointers.set(e.id,new pi(e.pos,e.id))}),this.down(t,this.pointers)}movePointer(t){t.forEach(e=>{var n;(n=this.pointers.get(e.id))==null||n.setPos(e.pos)}),this.move(t)}removePointer(t){t.forEach(e=>{this.pointers.delete(e.id)}),this.up(t,this.pointers)}};let xt=tt;C(xt,"POINTER_ID",-1);let c={editingCircle:{radius:50,mass:1},running:!0,traceFreq:20,drawTraces:!0,traceWidth:1/2,world:{restetution:1,motionEnabledStore:gi(!1),motionEnabled:!1,gravity:25,velocity:25},stepsPerFrame:10},lt=200,S,dt,yt,Le=0,T,Fe=0,x,qe=new m(0,0),at=new m(0,0);function At(){return Fe}function $e(){dt.clear()}function Re(){if(x){let r=k.findIndex(t=>t===x);k.splice(r,1),x=void 0}}function We(r){dt=Pt.fromParent(r),S=Pt.fromParent(r),new Ce(S.element),new Ce(dt.element),yt=new xt(S.element),yt.down=(n,i)=>{let s=new m(window.innerWidth,window.innerHeight).subS(lt/2);n.forEach(l=>{if(l.pos.sub(s).magnitude()<c.editingCircle.radius&&(T={pos:s.copy(),pointer:l.id}),x&&x.pos.add(x.vel.divS(10)).sub(l.pos).magnitude()<x.radius){i.get(l.id).data.draggingVel=x;return}k.forEach(o=>{o.pos.sub(l.pos).magnitude()<o.radius&&(i.get(l.id).data.dragging=o)})})},yt.up=n=>{n.forEach(i=>{T&&T.pointer===i.id&&(Ne()&&k.push(new St(T.pos,c.editingCircle.radius,c.editingCircle.mass)),T=void 0)})},S.element.addEventListener("click",n=>{let i=new m(n.clientX,n.clientY);for(const s of k)if(s.pos.sub(i).magnitude()<s.radius){x=s;return}x=void 0});let t=Date.now()/1e3;const e=()=>{const n=Date.now()/1e3,i=n-t;mi(i),requestAnimationFrame(e),t=n,Fe=1/i};requestAnimationFrame(e)}function Ae(){if(c.world.motionEnabled)c.world.motionEnabledStore.set(!1),c.world.motionEnabled=!1;else{if(!("DeviceMotionEvent"in window)){alert("DeviceMotionEvent not supported");return}DeviceMotionEvent.requestPermission().then(r=>{if(r!=="granted"){alert("permission for DeviceMotionEvent not granted");return}c.world.motionEnabledStore.set(!0),c.world.motionEnabled=!0,window.addEventListener("devicemotion",t=>{let e=new Pe(t.accelerationIncludingGravity.x,t.accelerationIncludingGravity.y,t.accelerationIncludingGravity.z),n=new Pe(t.acceleration.x,t.acceleration.y,t.acceleration.z),i=e.sub(n);qe=new m(i.y,i.x).multS(-20*c.world.gravity),at=new m(n.y,n.x).multS(-2*c.world.velocity)})})}}function Ne(){for(const r of k)if(r.pos.sub(T.pos).magnitude()<r.radius+c.editingCircle.radius)return!1;return!0}const Ct=class{constructor(t,e,n){C(this,"id",Ct.id++);C(this,"pos");C(this,"oldPos");C(this,"vel");C(this,"radius");C(this,"mass");this.pos=t,this.vel=new m(0,0),this.radius=e,this.mass=n}get impulse(){return this.vel.multS(this.mass)}set impulse(t){this.vel=t.divS(this.mass)}update(t,e){let n=this.pos.add(this.vel.multS(t)),i=this.vel.copy();e.forEach(h=>{S.drawCircle(h.position,10,{color:p.blue}),S.drawLine(h.position,h.position.add(h.normal.multS(20)));const u=n.sub(h.position);let E=1/this.mass,_=1/h.other.mass,y=h.other.vel.sub(this.vel).dot(h.normal),b=c.world.restetution,I=-(1+b)*y/(E+_);i=this.vel.sub(h.normal.multS(I*E)),n=Ct.reflect(u,h.normal).add(h.position)}),this.oldPos=this.pos,this.pos=n,this.vel=i;let s=1e-5,l=.47,o=this.vel.magnitude()*(-s*l*this.radius);this.vel=this.vel.add(this.vel.multS(t*o)),c.world.motionEnabled&&(this.vel=this.vel.add(qe.multS(t)),this.vel=this.vel.add(at))}static reflect(t,e){return t.sub(e.multS(2*t.dot(e)))}getAllCollisions(t,e,n){return[...this.getCollisions(this.pos,t),...this.getWallCollision(n,this.pos)]}getCollisions(t,e){let n=[];return e.forEach(i=>{if(i!==this&&i.pos.sub(t).magnitude()<i.radius+this.radius){let s=i.pos.sub(t).normalized(),l=t.lerp(i.pos,this.radius/(this.radius+i.radius)).add(s.multS(-this.radius));n.push({normal:s,position:l,other:{vel:i.vel.copy(),mass:i.mass}})}}),n}getWallCollision(t,e){let n=[],i=this.getOvershoot(e,t),s=i.map(l=>-Math.sign(l));if(s.x!==0){s=new m(s.x,0);let l=e.sub(i);n.push({normal:s,position:l,other:{vel:new m(0,0),mass:Number.POSITIVE_INFINITY}})}if(s.y!==0){s=new m(0,s.y);let l=e.sub(i);n.push({normal:s,position:l,other:{vel:new m(0,0),mass:Number.POSITIVE_INFINITY}})}return n}getOvershoot(t,e){let n=this.outsideRect(t,e);return new m(n.left?t.x-this.radius:n.right?t.x-e.x+this.radius:0,n.top?t.y-this.radius:n.bottom?t.y-e.y+this.radius:0)}outsideRect(t,e){let n=t.x-this.radius<0,i=t.x+this.radius>e.x,s=t.y-this.radius<0,l=t.y+this.radius>e.y;return{genral:n||i||s||l,x:n||i,y:s||l,left:n,right:i,top:s,bottom:l}}lateUpdate(t){}draw(t,e){if(t.drawCircle(this.pos,this.radius),!c.running){let n=this.pos,i=n.add(this.vel.divS(10));t.drawLine(n,i,{cap:"round",width:12,color:p.white})}}bgDraw(t,e){if(c.drawTraces){let n=1/c.traceFreq;Le%n<c.traceWidth*n&&e.drawLine(this.oldPos,this.pos,{width:2})}}};let St=Ct;C(St,"id",0);let k=[];function mi(r){S.clear(),S.beginDraw();const t=new m(window.innerWidth,window.innerHeight),e=new m(t.x-lt,t.y);if(c.running){at=at.divS(c.stepsPerFrame);for(let i=0;i<c.stepsPerFrame;i++){let s=r/c.stepsPerFrame,l=k.map(o=>o.getAllCollisions(k,s,e));k.forEach((o,h)=>o.update(s,l[h])),k.forEach(o=>o.bgDraw(S,dt)),Le+=s}}k.forEach(i=>i.draw(S,dt)),at=new m(0,0),S.drawRect(new m(t.x-lt,0),new m(lt,t.y),{color:p.hex("#111111")});let n=t.subS(lt/2);if(S.drawCircle(n,c.editingCircle.radius),T&&S.drawCircle(T.pos,c.editingCircle.radius,{color:Ne()?p.hex("#005500"):p.hex("#333333")}),x)if(S.drawCircle(x.pos,x.radius+10,{borderColor:p.red,borderWidth:3,fill:!1}),c.running)S.drawLine(x.pos,x.pos.add(x.vel.divS(10)),{width:12,cap:"round",color:p.white}),S.drawLine(x.pos,x.pos.add(x.vel.divS(10)),{width:8,cap:"round",color:p.hex("#23393d")});else{let i=x.pos,s=i.add(x.vel.divS(10));S.drawLine(i,s,{cap:"round",width:12,color:p.white}),S.drawCircle(s,20,{color:p.white})}yt.pointers.forEach(i=>{const s=i.delta();if(S.drawCircle(i.pos,10,{color:p.hex("#555555")}),T&&T.pointer===i.id&&(T.pos=T.pos.add(s)),i.data.dragging){let l=i.data.dragging;c.running?l.vel=s.divS(r):l.pos=l.pos.add(s)}if(i.data.draggingVel){let l=i.data.draggingVel;l.vel=l.vel.add(s.multS(10))}}),S.endDraw()}const F=Object.freeze(Object.defineProperty({__proto__:null,init:We,settings:c,getFramerate:At,clearPaper:$e,enableMotion:Ae,removeSelected:Re},Symbol.toStringTag,{value:"Module"}));function vi(r){var _;let t,e,n,i,s,l,o=((_=r[2])!=null?_:"")+"",h,u,E;return{c(){t=w("div"),e=w("div"),n=U(r[1]),i=U(`:
        `),s=w("input"),l=v(),h=U(o),P(s,"type","number"),s.value=r[0],P(s,"class","svelte-121lgjv"),P(e,"class","label svelte-121lgjv"),P(t,"class","slider")},m(y,b){Me(y,t,b),a(t,e),a(e,n),a(e,i),a(e,s),r[10](s),a(e,l),a(e,h),u||(E=[L(s,"input",r[11]),L(t,"pointerdown",r[4]),L(t,"pointermove",ti(r[6])),L(t,"pointerup",r[5]),L(t,"pointercancel",r[5]),L(t,"pointerleave",r[5])],u=!0)},p(y,[b]){var I;b&2&&Et(n,y[1]),b&1&&s.value!==y[0]&&(s.value=y[0]),b&4&&o!==(o=((I=y[2])!=null?I:"")+"")&&Et(h,o)},i:j,o:j,d(y){y&&Vt(t),r[10](null),u=!1,et(E)}}}function wi(r,t,e){let{label:n}=t,{value:i}=t,{min:s=void 0}=t,{max:l=void 0}=t,{step:o=1}=t,{unit:h=void 0}=t,u,E;function _(f){f.currentTarget.setPointerCapture(f.pointerId),E=f.clientX}function y(f){E=void 0}function b(f){if(E!==void 0){let J=f.clientX-E;e(0,i+=J*o*(f.shiftKey?10:1)/(f.ctrlKey?10:1)),e(0,i=Math.round(i/o)*o),s!==void 0&&e(0,i=Math.max(i,s)),l!==void 0&&e(0,i=Math.min(i,l)),E=f.clientX}}function I(f){D[f?"unshift":"push"](()=>{u=f,e(3,u)})}const M=f=>{e(0,i=parseFloat(f.currentTarget.value)),isNaN(i)&&e(0,i=0)};return r.$$set=f=>{"label"in f&&e(1,n=f.label),"value"in f&&e(0,i=f.value),"min"in f&&e(7,s=f.min),"max"in f&&e(8,l=f.max),"step"in f&&e(9,o=f.step),"unit"in f&&e(2,h=f.unit)},[i,n,h,u,_,y,b,s,l,o,I,M]}class K extends De{constructor(t){super(),Te(this,t,wi,vi,Nt,{label:1,value:0,min:7,max:8,step:9,unit:2})}}function _i(r){let t,e,n,i,s,l,o,h,u,E,_,y,b,I,M,f,J,ct,g,ht,Ot,q,It,Xt,jt,Yt,ft,Bt,$,Mt,Ht,R,zt,Gt,it,Kt,Ut,Jt,gt,Qt,W,Tt,Zt,nt,te,ee,ie,pt,ne,rt,mt=r[3]?"disable":"enable",Dt,re,A,kt,se,N,Lt,le,oe,ae,vt,Q,Ft,ue;function Ve(d){r[7](d)}let de={label:"steps",min:1,max:1e3,step:10};r[0].settings.stepsPerFrame!==void 0&&(de.value=r[0].settings.stepsPerFrame),M=new K({props:de}),D.push(()=>H(M,"value",Ve));function Oe(d){r[8](d)}let ce={label:"restetution",min:0,max:1,step:.01};r[0].settings.world.restetution!==void 0&&(ce.value=r[0].settings.world.restetution),q=new K({props:ce}),D.push(()=>H(q,"value",Oe));function Xe(d){r[9](d)}let he={label:"radius",min:10,max:100,step:1};r[0].settings.editingCircle.radius!==void 0&&(he.value=r[0].settings.editingCircle.radius),$=new K({props:he}),D.push(()=>H($,"value",Xe));function je(d){r[10](d)}let fe={label:"mass",min:1};r[0].settings.editingCircle.mass!==void 0&&(fe.value=r[0].settings.editingCircle.mass),R=new K({props:fe}),D.push(()=>H(R,"value",je));function Ye(d){r[12](d)}let ge={label:"draw freq",min:1,max:60,step:1,unit:"Hz"};r[0].settings.traceFreq!==void 0&&(ge.value=r[0].settings.traceFreq),W=new K({props:ge}),D.push(()=>H(W,"value",Ye));function Be(d){r[15](d)}let pe={label:"gravity",min:0,max:100,step:1};r[0].settings.world.gravity!==void 0&&(pe.value=r[0].settings.world.gravity),A=new K({props:pe}),D.push(()=>H(A,"value",Be));function He(d){r[16](d)}let me={label:"velocity",min:0,max:100,step:1};return r[0].settings.world.velocity!==void 0&&(me.value=r[0].settings.world.velocity),N=new K({props:me}),D.push(()=>H(N,"value",He)),{c(){t=w("div"),e=w("div"),n=v(),i=w("div"),s=w("div"),s.textContent="Simulation",l=v(),o=w("div"),h=U("fps: "),u=U(r[2]),E=v(),_=w("label"),_.textContent="running:",y=v(),b=w("input"),I=v(),G(M.$$.fragment),J=v(),ct=w("hr"),g=v(),ht=w("div"),ht.textContent="World",Ot=v(),G(q.$$.fragment),Xt=v(),jt=w("hr"),Yt=v(),ft=w("div"),ft.textContent="Object",Bt=v(),G($.$$.fragment),Ht=v(),G(R.$$.fragment),Gt=v(),it=w("div"),it.textContent="delete selected",Kt=v(),Ut=w("hr"),Jt=v(),gt=w("div"),gt.textContent="Paper",Qt=v(),G(W.$$.fragment),Zt=v(),nt=w("div"),nt.textContent="clear",te=v(),ee=w("hr"),ie=v(),pt=w("div"),pt.textContent="Device Motion",ne=v(),rt=w("div"),Dt=U(mt),re=v(),G(A.$$.fragment),se=v(),G(N.$$.fragment),le=v(),oe=w("hr"),ae=v(),vt=w("div"),vt.textContent="pause",P(e,"class","canvas-container svelte-172coa0"),P(s,"class","heading svelte-172coa0"),P(_,"for","check-running"),P(b,"type","checkbox"),P(b,"id","check-running"),P(ht,"class","heading svelte-172coa0"),P(ft,"class","heading svelte-172coa0"),P(it,"class","btn svelte-172coa0"),P(gt,"class","heading svelte-172coa0"),P(nt,"class","btn svelte-172coa0"),P(pt,"class","heading svelte-172coa0"),P(rt,"class","btn svelte-172coa0"),P(vt,"class","btn svelte-172coa0"),P(i,"class","ui svelte-172coa0"),P(t,"class","container svelte-172coa0")},m(d,z){Me(d,t,z),a(t,e),r[5](e),a(t,n),a(t,i),a(i,s),a(i,l),a(i,o),a(o,h),a(o,u),a(i,E),a(i,_),a(i,y),a(i,b),b.checked=r[0].settings.running,a(i,I),O(M,i,null),a(i,J),a(i,ct),a(i,g),a(i,ht),a(i,Ot),O(q,i,null),a(i,Xt),a(i,jt),a(i,Yt),a(i,ft),a(i,Bt),O($,i,null),a(i,Ht),O(R,i,null),a(i,Gt),a(i,it),a(i,Kt),a(i,Ut),a(i,Jt),a(i,gt),a(i,Qt),O(W,i,null),a(i,Zt),a(i,nt),a(i,te),a(i,ee),a(i,ie),a(i,pt),a(i,ne),a(i,rt),a(rt,Dt),a(i,re),O(A,i,null),a(i,se),O(N,i,null),a(i,le),a(i,oe),a(i,ae),a(i,vt),Q=!0,Ft||(ue=[L(b,"change",r[6]),L(it,"click",r[11]),L(nt,"click",r[13]),L(rt,"click",r[14])],Ft=!0)},p(d,[z]){(!Q||z&4)&&Et(u,d[2]),z&1&&(b.checked=d[0].settings.running);const ve={};!f&&z&1&&(f=!0,ve.value=d[0].settings.stepsPerFrame,Y(()=>f=!1)),M.$set(ve);const we={};!It&&z&1&&(It=!0,we.value=d[0].settings.world.restetution,Y(()=>It=!1)),q.$set(we);const _e={};!Mt&&z&1&&(Mt=!0,_e.value=d[0].settings.editingCircle.radius,Y(()=>Mt=!1)),$.$set(_e);const be={};!zt&&z&1&&(zt=!0,be.value=d[0].settings.editingCircle.mass,Y(()=>zt=!1)),R.$set(be);const xe={};!Tt&&z&1&&(Tt=!0,xe.value=d[0].settings.traceFreq,Y(()=>Tt=!1)),W.$set(xe),(!Q||z&8)&&mt!==(mt=d[3]?"disable":"enable")&&Et(Dt,mt);const ye={};!kt&&z&1&&(kt=!0,ye.value=d[0].settings.world.gravity,Y(()=>kt=!1)),A.$set(ye);const Se={};!Lt&&z&1&&(Lt=!0,Se.value=d[0].settings.world.velocity,Y(()=>Lt=!1)),N.$set(Se)},i(d){Q||(V(M.$$.fragment,d),V(q.$$.fragment,d),V($.$$.fragment,d),V(R.$$.fragment,d),V(W.$$.fragment,d),V(A.$$.fragment,d),V(N.$$.fragment,d),Q=!0)},o(d){B(M.$$.fragment,d),B(q.$$.fragment,d),B($.$$.fragment,d),B(R.$$.fragment,d),B(W.$$.fragment,d),B(A.$$.fragment,d),B(N.$$.fragment,d),Q=!1},d(d){d&&Vt(t),r[5](null),X(M),X(q),X($),X(R),X(W),X(A),X(N),Ft=!1,et(ue)}}}function bi(r,t,e){let n,i,s=At().toFixed(),l=c.world.motionEnabledStore;Ze(r,l,g=>e(3,n=g)),setInterval(g=>e(2,s=At().toFixed()),100),ni(()=>{We(i)});function o(g){D[g?"unshift":"push"](()=>{i=g,e(1,i)})}function h(){c.running=this.checked,e(0,F)}function u(g){r.$$.not_equal(c.stepsPerFrame,g)&&(c.stepsPerFrame=g,e(0,F))}function E(g){r.$$.not_equal(c.world.restetution,g)&&(c.world.restetution=g,e(0,F))}function _(g){r.$$.not_equal(c.editingCircle.radius,g)&&(c.editingCircle.radius=g,e(0,F))}function y(g){r.$$.not_equal(c.editingCircle.mass,g)&&(c.editingCircle.mass=g,e(0,F))}const b=g=>Re();function I(g){r.$$.not_equal(c.traceFreq,g)&&(c.traceFreq=g,e(0,F))}const M=g=>$e(),f=g=>Ae();function J(g){r.$$.not_equal(c.world.gravity,g)&&(c.world.gravity=g,e(0,F))}function ct(g){r.$$.not_equal(c.world.velocity,g)&&(c.world.velocity=g,e(0,F))}return[F,i,s,n,l,o,h,u,E,_,y,b,I,M,f,J,ct]}class xi extends De{constructor(t){super(),Te(this,t,bi,_i,Nt,{})}}new xi({target:document.getElementById("app")});
